<ConfigButton@Button>:
    background_normal: ''
    background_color: .4, .5, .6, .85
    font_size: 30

<CustButton@Button>:
    background_normal: ''
    background_color: .1, .2, .3, .85
    font_size: 30

<TopButton@Button>:
    background_normal: ''
    background_color: .1, .2, .3, .85
    font_size: 20
    size_hint: .3, .2

<CustLabel@Label>:
    size_hint: .5, .8
    font_size: 30

<VertLayout@BoxLayout>:
    spacing: 10
    orientation: 'vertical'

<HorLayout@BoxLayout>:
    spacing: 10

MyScreenManager:
    IntroScreen:
    WelcomeScreen:

<IntroScreen>:
    name: 'intro'
    VertLayout:
        Label:
            text: "Daily Hero Story Generator!"
            font_size: 30
#        ConfigButton:
#            text: "Configure The Generator"
#            on_press: root.run_config()
        Spinner:
            background_normal: ''
            background_color: .2, .3, .4, .85
            text: "Choose Your Theme"
            font_size: 30
            values: root.themes+["(create a theme)"]
            id: theme
            on_text: root.spinner_clicked(theme.text)

        CustButton:
            text: 'Generate Your Story!'
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.transition.duration = 1
                root.manager.current = 'welcome'

<WelcomeScreen>:
    name: 'welcome'
    VertLayout:
        TopButton:
            text: "Back to Home"
            on_press: root.manager.current = 'intro'
        Label:
            text: "Daily Hero Story Generator"
            font_size: 30
        Image:
            source: root.img_bkg
            allow_stretch: False
            keep_ratio: True
        VertLayout:
            CustButton:
                text: 'Choose a Hero at Random'
                font_size: 30
                on_press: root.random_hero()
                on_release: app.root.open_story_screen_popup()
            CustButton:
                text: 'Choose Your Own Hero'
                font_size: 30
                on_release: app.root.new_hero()

<ScrollingScreen>:
    HorLayout:
        orientation: 'vertical'
        TopButton:
            text: "Back to Home"
            on_press: root.manager.current = 'intro'
        HorLayout:
            Label:
                text: "Hero"
                font_size: 30
            Label:
                text: "Ennemy"
                font_size: 30
        HorLayout:
            Image:
                source: root.img_hero
                allow_stretch: False
                keep_ratio: True
            Image:
                source: root.img_villain
                allow_stretch: False
                keep_ratio: True
        HorLayout:
            CustButton:
                size_hint: (.5, .5)
                text: 'YES'
                on_release: app.root.open_story_screen_popup()
            CustButton:
                size_hint: (.5, .5)
                text: 'NO'
                on_release: app.root.new_hero()
            CustButton:
                size_hint: (.5, .5)
                text: 'At Random'
                on_press: root.random_hero()
                on_release: app.root.open_story_screen_popup()

#-------------- POPUPS --------------------

<ConfigPopup>:
    title: "Create Your Theme"
    VertLayout:
        TopButton:
            text: "Back"
            on_press: root.dismiss()
        Label:
            color: 1,1,1,1
            font_size: 20
            text: "Create Your Theme! Press Enter to Save Each Entry. Repeat as needed."
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 1
                Rectangle:
                    pos: self.pos
                    size: self.size
        HorLayout:
            CustLabel:
                text: "Heroes and Villains"
            BoxLayout:
                orientation: 'horizontal'
                BoxLayout:
                    orientation: 'vertical'
                    TextInput:
                        id : hero_name
                        hint_text:"Enter the name of a Hero."
                        font_size: 20
                        size_hint: 1, 1
                    TextInput:
                        id : villain_name
                        hint_text:"Enter the name of his/her Villain."
                        font_size: 20
                        size_hint: 1, 1
                CustButton:
                    text: "Enter"
                    font_size: 10
                    size_hint: .165, 1
                    on_press: root.write_hero_and_villains()
        HorLayout:
            CustLabel:
                text: "Cities"
            BoxLayout:
                orientation: 'horizontal'
                TextInput:
                    id: city_name
                    hint_text: "Enter a city name."
                    font_size: 20
                    size_hint: .6, 1
                CustButton:
                    text: "Enter"
                    font_size: 10
                    size_hint: .1, 1
                    on_press: root.write_cities()
        HorLayout:
            CustLabel:
                text: "Story Beginnings"
            BoxLayout:
                orientation: 'horizontal'
                TextInput:
                    id: story_beginning
                    hint_text:"Enter the beginning of a story."
                    font_size: 20
                    size_hint: .6, 1
                CustButton:
                    text: "Enter"
                    font_size: 10
                    size_hint: .1, 1
                    on_press: root.write_story_beg()
        HorLayout:
            CustLabel:
                text: "Triggers"
            BoxLayout:
                orientation: 'horizontal'
                TextInput:
                    id: trigger
                    hint_text:"Enter a story trigger."
                    font_size: 20
                    size_hint: .6, 1
                CustButton:
                    text: "Enter"
                    font_size: 10
                    size_hint: .1, 1
                    on_press: root.write_trigger()
        CustButton:
            text: "Save and quit\n(reopen app to use your theme)"
            on_press: root.save_config()
            on_release: app.stop()

<StoryScreenPopUp>:
    title: " "
    VertLayout:
        TopButton:
            text: "Back"
            on_press: root.dismiss()
        HorLayout:
            Label:
                text: root.name_hero
                font_size: 20
            Label:
                font_size: 20
            Label:
                text: root.name_villain
                font_size: 20
        HorLayout:
            Image:
                source: root.img_hero
                allow_stretch: False
                keep_ratio: True
            Image:
                source: root.img_vs
                allow_stretch: False
                keep_ratio: True
            Image:
                source: root.img_villain
                allow_stretch: False
                keep_ratio: True
        Label:
            text: "The story takes place at "+root.name_city
            font_size: 30
        CustButton:
            text: "Start the Story"
            on_press: root.open_begin_story_popup()

<BeginStoryPopUp>:
    title: " "
    VertLayout:
        TopButton:
            text: "Back"
            on_press: root.dismiss()
        Label:
            text: "The story begins..."
            font_size: 30
        ScrollView:
            size_hint: 1, 1
            TextInput:
                font_size:20
                height: self.minimum_height
                color: 1,1,1,.5
                size_hint_y: None
                readonly: True
                text: root.beginning
        CustButton:
            text: "Quit"
            on_press: app.stop()

<CreateThemePopup>:
    title: "Create A Theme"
    size_hint: .8, .4
    BoxLayout:
        orientation: "vertical"
        BoxLayout:
            orientation: "horizontal"
            CustLabel:
                text: "Enter a theme name: "
                size_hint: .8, 1
            TextInput:
                id: custom_theme
                font_size: 20
                size_hint: .8, 1
        CustButton:
            text: "Save"
            on_press: root.run_config()
            on_release: root.dismiss()

<ErrorPopup>:
    title: "ERROR!"
    VertLayout:
        Label:
            text: "This Theme Is Not Ready Yet."
            font_size: 20
            size_hint: .8, 1
        CustButton:
            text: "CONFIGURE IT"
            on_press: root.open_config()
            on_release: root.dismiss()
        CustButton:
            text: "CANCEL"
            on_press: root.dismiss()